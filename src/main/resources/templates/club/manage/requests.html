<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>가입 신청 관리</title>
    <style>
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); }
        .modal-content { background: white; margin: 15% auto; padding: 20px; width: 400px; border-radius: 8px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 10px; text-align: center; }
    </style>
</head>
<body>

<h1>가입 신청 현황</h1>

<nav class="manage-tabs">
    <a th:href="@{/club/{id}/manage/requests(id=${clubId})}" class="tab-link active">신청 현황</a>

    <a th:href="@{/club/{id}/manage/edit(id=${clubId})}" class="tab-link">정보 수정</a>

    <a th:href="@{/club/{id}/manage/members(id=${clubId})}" class="tab-link">멤버 관리</a>

    <a th:href="@{/club/{id}/manage/delete(id=${clubId})}" class="tab-link delete-link">삭제하기</a>

    <a th:href="@{/club/{id}(id=${clubId})}" class="tab-link">상세페이지로 돌아가기</a>
</nav>


<table border="1">
    <thead>
    <tr>
        <th>신청자 ID</th>
        <th>신청자 이름</th>
        <th>가입 답변</th> <th>신청 일시</th> <th>관리</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="request : ${joinRequests}">
        <td th:text="${request.memberId}">아이디</td>
        <td th:text="${request.memberName}">이름</td>
        <td th:text="${request.answerText}">답변 내용</td>
        <td th:text="${#temporals.format(request.appliedAt, 'yyyy-MM-dd')}">2026-01-22</td>
        <td>
            <form th:action="@{|/club/${clubId}/manage/approve|}" method="post" style="display:inline;">
                <input type="hidden" name="memberId" th:value="${request.memberId}">
                <button type="submit" onclick="return confirm('승인하시겠습니까?')"
                        style="background-color: #28a745; color: white; border: none; padding: 5px 10px; cursor: pointer;">승인</button>
            </form>

            <form th:action="@{|/club/${clubId}/manage/reject|}" method="post" style="display:inline;">
                <input type="hidden" name="memberId" th:value="${request.memberId}">
                <button type="submit" onclick="return confirm('거절하시겠습니까?')"
                        style="background-color: #dc3545; color: white; border: none; padding: 5px 10px; cursor: pointer;">거절</button>
            </form>
        </td>
    </tr>
    <tr th:if="${#lists.isEmpty(joinRequests)}">
        <td colspan="5">대기 중인 신청자가 없습니다.</td>
    </tr>
    </tbody>
</table>

<div id="manageModal" class="modal">
    <div class="modal-content">
        <h3>가입 신청 상세 확인</h3>
        <hr>
        <p><strong>신청자:</strong> <span id="modalMemberName"></span> (<span id="modalMemberId"></span>)</p>
        <p><strong>가입 답변:</strong></p>
        <div id="modalAnswerText" style="background: #f4f4f4; padding: 10px; border-radius: 5px; min-height: 50px;"></div>
        <div style="text-align: right; margin-top: 10px;">
            <button type="button" onclick="closeManageModal()">닫기</button>
        </div>
    </div>
</div>

<script th:inline="javascript">
    const clubId = [[${clubId}]];

    function closeManageModal() {
        document.getElementById('manageModal').style.display = 'none';
    }

    window.onclick = function(event) {
        if (event.target == document.getElementById('manageModal')) {
            closeManageModal();
        }
    }
</script>



</body>
</html>